#!/bin/bash

# ุจูุช ุญุฐู ุงูุฅุนูุงูุงุช ุงููุฒุนุฌุฉ - ุณูุฑูุจุช ุงูุชุซุจูุช ูู Linux/Mac
# Telegram Spam Killer Bot - Linux/Mac Setup Script

echo ""
echo "======================================================================"
echo "๐ ุจูุช ุญุฐู ุงูุฅุนูุงูุงุช ุงููุฒุนุฌุฉ - ุณูุฑูุจุช ุงูุชุซุจูุช"
echo "======================================================================"
echo ""

# ุงูุชุญูู ูู Python
if ! command -v python3 &> /dev/null; then
    echo "โ ุฎุทุฃ: Python3 ุบูุฑ ูุซุจุช ุนูู ุฌูุงุฒู"
    echo ""
    echo "๐ฅ ุงูุญู:"
    echo "ุนูู Ubuntu/Debian:"
    echo "  sudo apt-get install python3 python3-venv python3-pip"
    echo ""
    echo "ุนูู macOS:"
    echo "  brew install python3"
    echo ""
    exit 1
fi

echo "โ ุชู ุงูุชุดุงู Python"
python3 --version
echo ""

# ุฅูุดุงุก ุจูุฆุฉ ุงูุชุฑุงุถูุฉ
echo "๐ฆ ุฌุงุฑู ุฅูุดุงุก ุจูุฆุฉ ุงูุชุฑุงุถูุฉ..."
if [ -d "venv" ]; then
    echo "โน๏ธ ุงูุจูุฆุฉ ุงูุงูุชุฑุงุถูุฉ ููุฌูุฏุฉ ุจุงููุนู"
else
    python3 -m venv venv
    if [ $? -ne 0 ]; then
        echo "โ ูุดู ุฅูุดุงุก ุงูุจูุฆุฉ ุงูุงูุชุฑุงุถูุฉ"
        exit 1
    fi
    echo "โ ุชู ุฅูุดุงุก ุงูุจูุฆุฉ ุงูุงูุชุฑุงุถูุฉ"
fi
echo ""

# ุชูุนูู ุงูุจูุฆุฉ ุงูุงูุชุฑุงุถูุฉ
echo "๐ง ุฌุงุฑู ุชูุนูู ุงูุจูุฆุฉ ุงูุงูุชุฑุงุถูุฉ..."
source venv/bin/activate
if [ $? -ne 0 ]; then
    echo "โ ูุดู ุชูุนูู ุงูุจูุฆุฉ ุงูุงูุชุฑุงุถูุฉ"
    exit 1
fi
echo "โ ุชู ุชูุนูู ุงูุจูุฆุฉ ุงูุงูุชุฑุงุถูุฉ"
echo ""

# ุชุญุฏูุซ pip
echo "๐ฅ ุฌุงุฑู ุชุญุฏูุซ pip..."
python3 -m pip install --upgrade pip > /dev/null 2>&1
echo "โ ุชู ุชุญุฏูุซ pip"
echo ""

# ุชุซุจูุช ุงูููุชุจุงุช
echo "๐ ุฌุงุฑู ุชุซุจูุช ุงูููุชุจุงุช ุงููุทููุจุฉ..."
echo "(ูุฐุง ูุฏ ูุณุชุบุฑู ุฏูููุฉ ุฃู ุฏูููุชูู)"
echo ""

if [ -f "requirements.txt" ]; then
    pip install -r requirements.txt
else
    echo "โ ููู requirements.txt ุบูุฑ ููุฌูุฏ"
    exit 1
fi

if [ $? -ne 0 ]; then
    echo "โ ูุดู ุชุซุจูุช ุงูููุชุจุงุช"
    echo ""
    echo "๐ก ุงูุญู ุงูุจุฏูู:"
    echo "pip install -r requirements_minimal.txt"
    echo ""
    exit 1
fi

echo "โ ุชู ุชุซุจูุช ุฌููุน ุงูููุชุจุงุช"
echo ""

# ุฅูุดุงุก ููู .env
echo "๐ ุฌุงุฑู ุฅุนุฏุงุฏ ููู ุงูุฅุนุฏุงุฏุงุช..."
if [ -f ".env" ]; then
    echo "โน๏ธ ููู .env ููุฌูุฏ ุจุงููุนู"
else
    if [ -f ".env.example" ]; then
        cp .env.example .env
        echo "โ ุชู ุฅูุดุงุก ููู .env"
    else
        echo "โ ููู .env.example ุบูุฑ ููุฌูุฏ"
    fi
fi
echo ""

# ุฅุธูุงุฑ ุงูุชุนูููุงุช
echo "======================================================================"
echo "โ ุชู ุงูุชุซุจูุช ุจูุฌุงุญ!"
echo "======================================================================"
echo ""
echo "๐ ุงูุฎุทูุฉ ุงูุชุงููุฉ:"
echo "1. ุงูุชุญ ููู .env ุจูุญุฑุฑ ูุตูุต:"
echo "   nano .env"
echo "2. ุฃุถู ุฑูุฒ ุงูุจูุช:"
echo "   TELEGRAM_BOT_TOKEN=your_token_here"
echo "3. ุงุณุชุจุฏู your_token_here ุจุฑูุฒ ุงูุจูุช ุงูุญูููู"
echo "4. ุงุญูุธ ุงูููู (Ctrl+O ุซู Ctrl+X)"
echo ""
echo "๐ก ููุญุตูู ุนูู ุฑูุฒ ุงูุจูุช:"
echo "1. ุงูุชุญ ุชููุฑุงู ูุงุจุญุซ ุนู @BotFather"
echo "2. ุฃุฑุณู: /newbot"
echo "3. ุงุชุจุน ุงูุชุนูููุงุช"
echo "4. ุงูุณุฎ ุงูุฑูุฒ"
echo ""
echo "๐ ูุชุดุบูู ุงูุจูุช:"
echo "python3 main.py"
echo ""
echo "๐ ูููุณุงุนุฏุฉ:"
echo "ุงูุฑุฃ ููู README_USER.md"
echo ""
echo "======================================================================"
echo ""
